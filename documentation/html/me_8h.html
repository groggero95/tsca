<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TscaDocumentation: /home/ansel/Desktop/Eurecom/SemesterProject/tsca/include/me.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="T_LARGE.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">TscaDocumentation
   </div>
   <div id="projectbrief">Timing side channel attack on modular exponentiation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">me.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="panda4x4_8h_source.html">panda4x4.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for me.h:</div>
<div class="dyncontent">
<div class="center"><img src="me_8h__incl.png" border="0" usemap="#_2home_2ansel_2Desktop_2Eurecom_2SemesterProject_2tsca_2include_2me_8h" alt=""/></div>
<map name="_2home_2ansel_2Desktop_2Eurecom_2SemesterProject_2tsca_2include_2me_8h" id="_2home_2ansel_2Desktop_2Eurecom_2SemesterProject_2tsca_2include_2me_8h">
<area shape="rect" id="node2" href="panda4x4_8h.html" title="panda4x4.h" alt="" coords="50,109,139,136"/>
</map>
</div>
</div>
<p><a href="me_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab111df2fad7fea4407d938fa12ea14b0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="me_8h.html#ab111df2fad7fea4407d938fa12ea14b0">me</a> (unsigned int e, unsigned int n, unsigned int c0, unsigned int s0, unsigned int nb)</td></tr>
<tr class="memdesc:ab111df2fad7fea4407d938fa12ea14b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modular Exponentiation using integers.  <a href="#ab111df2fad7fea4407d938fa12ea14b0">More...</a><br /></td></tr>
<tr class="separator:ab111df2fad7fea4407d938fa12ea14b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1965c943cf64aae0ee5f64372723d862"><td class="memItemLeft" align="right" valign="top"><a class="el" href="bigint_8h.html#aed99b7fbc5462db206761f74a33eddb1">bigint_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="me_8h.html#a1965c943cf64aae0ee5f64372723d862">ME_big</a> (<a class="el" href="bigint_8h.html#aed99b7fbc5462db206761f74a33eddb1">bigint_t</a> e, <a class="el" href="bigint_8h.html#aed99b7fbc5462db206761f74a33eddb1">bigint_t</a> m, <a class="el" href="bigint_8h.html#aed99b7fbc5462db206761f74a33eddb1">bigint_t</a> n, <a class="el" href="bigint_8h.html#aed99b7fbc5462db206761f74a33eddb1">bigint_t</a> k0, int nb)</td></tr>
<tr class="memdesc:a1965c943cf64aae0ee5f64372723d862"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modular Exponentiation using <a class="el" href="bigint_8h.html#aed99b7fbc5462db206761f74a33eddb1">bigint_t</a>.  <a href="#a1965c943cf64aae0ee5f64372723d862">More...</a><br /></td></tr>
<tr class="separator:a1965c943cf64aae0ee5f64372723d862"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b21f6dcf0d17bb1f74c18c3396db66b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="bigint_8h.html#aed99b7fbc5462db206761f74a33eddb1">bigint_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="me_8h.html#a5b21f6dcf0d17bb1f74c18c3396db66b">ME_big_blind</a> (<a class="el" href="bigint_8h.html#aed99b7fbc5462db206761f74a33eddb1">bigint_t</a> e, <a class="el" href="bigint_8h.html#aed99b7fbc5462db206761f74a33eddb1">bigint_t</a> m, <a class="el" href="bigint_8h.html#aed99b7fbc5462db206761f74a33eddb1">bigint_t</a> n, <a class="el" href="bigint_8h.html#aed99b7fbc5462db206761f74a33eddb1">bigint_t</a> k0, int nb)</td></tr>
<tr class="memdesc:a5b21f6dcf0d17bb1f74c18c3396db66b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modular Exponentiation with blinding countermeasure.  <a href="#a5b21f6dcf0d17bb1f74c18c3396db66b">More...</a><br /></td></tr>
<tr class="separator:a5b21f6dcf0d17bb1f74c18c3396db66b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8a98312c6d54ca51c887fd133160695"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="me_8h.html#aa8a98312c6d54ca51c887fd133160695">ME_big_estimate</a> (uint32_t bits, <a class="el" href="structmsg__t.html">msg_t</a> *m, <a class="el" href="bigint_8h.html#aed99b7fbc5462db206761f74a33eddb1">bigint_t</a> n, int bits_step)</td></tr>
<tr class="memdesc:aa8a98312c6d54ca51c887fd133160695"><td class="mdescLeft">&#160;</td><td class="mdescRight">Estimate the time employed by part of the modular exponentiation.  <a href="#aa8a98312c6d54ca51c887fd133160695">More...</a><br /></td></tr>
<tr class="separator:aa8a98312c6d54ca51c887fd133160695"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ab111df2fad7fea4407d938fa12ea14b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab111df2fad7fea4407d938fa12ea14b0">&#9670;&nbsp;</a></span>me()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int me </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>c0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>s0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>nb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Modular Exponentiation using integers. </p>
<p>Performs <img class="formulaInl" alt="$ m^e \bmod n $" src="form_4.png"/>, this operation is called modular exponentiation. Instead of computing directly such operation we exploit the property of modular arithmetic an power to iteratively compute the outcome of this operation without the need of a very large amount of bit in order to represent the result of the power. The algorithm is based on square and multiply operation which are both performed using the Montgomery multiplication.</p>
<p>For the correct functioning of the function the base must be at maximum 29 bit in order to avoid overflow in the intermediate operation performed inside the function.</p>
<p>This function was used for testing the validity of the algorithm on a manageble number of bits. It does not have any other pourpose. Moreover the inputs are different than the standard one used later</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">e</td><td>Secret or public key, used as exponent for the power </td></tr>
    <tr><td class="paramname">n</td><td>Modulus, must be an odd number for the correctness of the function </td></tr>
    <tr><td class="paramname">c0</td><td>Number one in Montgomery domain, i.e. <img class="formulaInl" alt="$ 1 \cdot R \bmod n $" src="form_5.png"/>, it is used as starting point to compute the output of the function </td></tr>
    <tr><td class="paramname">s0</td><td>Message <em>m</em> in Montgomery domain, i.e. <img class="formulaInl" alt="$ m \cdot R \bmod n $" src="form_6.png"/>, it is this <em>m</em> which should be less than 30 bit </td></tr>
    <tr><td class="paramname">nb</td><td>Number of bit of the exponent </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The result of the modular exponentiation </dd></dl>

</div>
</div>
<a id="a1965c943cf64aae0ee5f64372723d862"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1965c943cf64aae0ee5f64372723d862">&#9670;&nbsp;</a></span>ME_big()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bigint_8h.html#aed99b7fbc5462db206761f74a33eddb1">bigint_t</a> ME_big </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bigint_8h.html#aed99b7fbc5462db206761f74a33eddb1">bigint_t</a>&#160;</td>
          <td class="paramname"><em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bigint_8h.html#aed99b7fbc5462db206761f74a33eddb1">bigint_t</a>&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bigint_8h.html#aed99b7fbc5462db206761f74a33eddb1">bigint_t</a>&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bigint_8h.html#aed99b7fbc5462db206761f74a33eddb1">bigint_t</a>&#160;</td>
          <td class="paramname"><em>k0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Modular Exponentiation using <a class="el" href="bigint_8h.html#aed99b7fbc5462db206761f74a33eddb1">bigint_t</a>. </p>
<p>Performs <img class="formulaInl" alt="$ m^e \bmod n $" src="form_4.png"/>, this operation is called modular exponentiation. Instead of computing directly such operation we exploit the propery of modular arithmetic and power to iteratively compute the outcome of this operation without the need of a very large amount of bit in order to represent the result of the power. The algorithm is based on square and multiply operation which are both performed using the Montgomery multiplication. Moreover it belongs to the class denoted as RL, since it cosumes the bits of the exponent from Right to Left, i.e. from the least significant to the most significant bit.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">e</td><td>Secret or public key, used as exponent for the power </td></tr>
    <tr><td class="paramname">m</td><td>Plaintext or ciphertext, used as base for the power </td></tr>
    <tr><td class="paramname">n</td><td>Modulus, must be an odd number for the correctness of the function </td></tr>
    <tr><td class="paramname">k0</td><td>Constant related to the modulus <em><code>n</code>.</em> It is used to convert a number into its Montgomery representation by means of a Montgomery multiplication. This parameter is computed as follow: <img class="formulaInl" alt="$ R^2 \bmod n $" src="form_7.png"/> </td></tr>
    <tr><td class="paramname">nb</td><td>Number of bit of the exponent </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The result of the modular exponentiation</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="mm_8h.html#a70f6334d986cd1c4f499132571c1272b" title="Modular Exponentiation using integers. ">MM_big</a>, <a class="el" href="bigint_8h.html#aed99b7fbc5462db206761f74a33eddb1" title="Structure to hold large fixed size unsigned integer. ">bigint_t</a> </dd></dl>

</div>
</div>
<a id="a5b21f6dcf0d17bb1f74c18c3396db66b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b21f6dcf0d17bb1f74c18c3396db66b">&#9670;&nbsp;</a></span>ME_big_blind()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bigint_8h.html#aed99b7fbc5462db206761f74a33eddb1">bigint_t</a> ME_big_blind </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bigint_8h.html#aed99b7fbc5462db206761f74a33eddb1">bigint_t</a>&#160;</td>
          <td class="paramname"><em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bigint_8h.html#aed99b7fbc5462db206761f74a33eddb1">bigint_t</a>&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bigint_8h.html#aed99b7fbc5462db206761f74a33eddb1">bigint_t</a>&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bigint_8h.html#aed99b7fbc5462db206761f74a33eddb1">bigint_t</a>&#160;</td>
          <td class="paramname"><em>k0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Modular Exponentiation with blinding countermeasure. </p>
<p>Performs a modular exponentiation but it implenets blinding in it to prevent timing side channel attack. Internally the function modify the input to the algorithm used to perform the modular eponantiation and then undo such modification to retrive the correct output. In this way we are hiding the real inputs of the function to an attacker, making thus the function less prone to leak information.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">e</td><td>Secret or public key, used as exponent for the power </td></tr>
    <tr><td class="paramname">m</td><td>Plaintext or ciphertext, used as base for the power </td></tr>
    <tr><td class="paramname">n</td><td>Modulus, must be an odd number for the correctness of the function </td></tr>
    <tr><td class="paramname">k0</td><td>Constant related to the modulus <em><code>n</code>.</em> It is used to convert a number into its Montgomery representation by means of a Montgomery multiplication. This parameter is computed as follow: <img class="formulaInl" alt="$ R^2 \bmod n $" src="form_7.png"/> </td></tr>
    <tr><td class="paramname">nb</td><td>Number of bit of the exponent </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The result of the modular exponentiation</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="mm_8h.html#a70f6334d986cd1c4f499132571c1272b" title="Modular Exponentiation using integers. ">MM_big</a>, <a class="el" href="bigint_8h.html#aed99b7fbc5462db206761f74a33eddb1" title="Structure to hold large fixed size unsigned integer. ">bigint_t</a> </dd></dl>

</div>
</div>
<a id="aa8a98312c6d54ca51c887fd133160695"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8a98312c6d54ca51c887fd133160695">&#9670;&nbsp;</a></span>ME_big_estimate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ME_big_estimate </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>bits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmsg__t.html">msg_t</a> *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bigint_8h.html#aed99b7fbc5462db206761f74a33eddb1">bigint_t</a>&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bits_step</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Estimate the time employed by part of the modular exponentiation. </p>
<p>Performs <em><code>bits_step</code> iteration</em> of the modular exponentiation, estimate the time taken and accumulate this estimate with the estimate of the previous steps. The timing model employed by this function is simply the number of branch taken while performing the intermediate operations of square and multiply.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bits</td><td>Contains the bit sequence of the exponent for which I want to execute the modular exponentiation algorithm </td></tr>
    <tr><td class="paramname">m</td><td>Struct containing the intermediate values resulted from the previous cycles of the modular exponentiation algorithm and the time estimated for those step and all the previous one </td></tr>
    <tr><td class="paramname">n</td><td>Modulus, must be an odd number for the correctness of the function </td></tr>
    <tr><td class="paramname">bits_step</td><td>Number of cycle of the modular exponentiation algorithm which I want to perform </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always return <code>NULL</code> </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="bigint_8h.html#aed99b7fbc5462db206761f74a33eddb1" title="Structure to hold large fixed size unsigned integer. ">bigint_t</a>, <a class="el" href="structmsg__t.html" title="Structure to hold information needed during the attack. ">msg_t</a>, <a class="el" href="mm_8h.html#acec76999d2f75292de0981cea9fda6e2" title="Estimate the time employed by a Montgomery modular multiplication. ">MM_big_estimate</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
